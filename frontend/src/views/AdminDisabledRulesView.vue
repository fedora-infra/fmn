<script setup lang="ts">
import { apiGet } from "@/api";
import type { Rule } from "@/api/types";
import { CAlert, CSpinner } from "@coreui/bootstrap-vue";
import type { QueryFunction } from "react-query/types/core";
import { useQuery } from "vue-query";
import AdminDisabledRulesList from "../components/AdminDisabledRulesList.vue";
import AdminSubHeader from "../components/AdminSubHeader.vue";

const url = `/api/v1/admin/rules`;
const { isLoading, isError, data, error } = useQuery(
  [url, { disabled: true }],
  apiGet as QueryFunction<Rule[]>,
  { retry: false }
);
</script>

<template>
  <div v-if="isLoading" class="text-center">
    <CSpinner />
  </div>
  <CAlert v-else-if="isError" color="danger">{{ error }}</CAlert>
  <template v-else-if="data">
    <AdminSubHeader />
    <AdminDisabledRulesList :rules="data" />
  </template>
</template>
